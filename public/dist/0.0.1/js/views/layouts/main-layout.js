import{a as f,b as C}from"../../chunk-ULXPTNPY.js";import{a as S}from"../../chunk-ZWDCRSBR.js";import{b as p,c as H,d as y}from"../../chunk-TVQHBZNT.js";import{a as I,b as m}from"../../chunk-OOUCEZ5I.js";var D=I((U,E)=>{var{BaseLayout:k}=f(),{ScrollActionTo:b,ScrollActionTop:q,ScrollEventType:B,SCROLL_THRESHOLD:A}=S(),{changeLangPath:F,toggleQueryParameter:h}=C(),{navigateHandler:c}=y(),{context:v}=H(),{DEFAULT_LANGUAGE:d,LANGUAGES:g}=p(),l=class extends k{node=null;appBarElem=null;drawerElem=null;navIcon=null;searchIcon=null;headerIconElem=null;headerIconBtn=null;signInUpElem=null;signOutElem=null;list=null;langList=null;langElem=null;langImageElem=null;searchPanel=null;searchForm=null;searchInput=null;navIconClickHandler;searchIconClickHandler;headerIconBtnClickHandler;addDrawerHoverClassHandler;removeDrawerHoverClassHandler;signInUpElemClickHandler;langListItemClickHandlers=[];searchInputFocusHandler;searchIconRightClickHandler;searchIconLeftClickHandler;searchFormSubmitHandler;windowScrollHandler;static get instance(){return l.layout||(l.layout=new l),l.layout}constructor(){super();this.navIconClickHandler=e=>c(e,this.navIcon),this.searchIconClickHandler=e=>c(e,this.searchIcon),this.headerIconBtnClickHandler=e=>c(e,this.headerIconBtn),this.addDrawerHoverClassHandler=()=>this.drawerElem?.classList.add("drawer-hover"),this.removeDrawerHoverClassHandler=()=>this.drawerElem?.classList.remove("drawer-hover"),this.signInUpElemClickHandler=e=>c(e,this.signInUpElem),this.searchInputFocusHandler=()=>this.searchPanel?.classList.add("search-focus"),this.searchIconRightClickHandler=()=>{this.searchInput&&(this.searchInput.value="",this.searchInput.focus())},this.searchIconLeftClickHandler=()=>{this.searchPanel?.classList.remove("search-focus"),this.searchInput?.blur()},this.searchFormSubmitHandler=e=>{e.preventDefault(),console.log("Form submited:",this.searchInput?.value),this.searchPanel?.classList.remove("search-focus"),this.searchInput?.blur()};let t=0;this.windowScrollHandler=()=>{let e=window.scrollY||0;Math.abs(e-t)>A&&(t>=e?this.appBarElem?.classList.remove("app-bar-hide"):this.appBarElem?.classList.add("app-bar-hide")),e<=0?this.appBarElem?.classList.remove("app-bar-scrolled"):this.appBarElem?.classList.add("app-bar-scrolled"),this.node?.dispatchEvent(new CustomEvent(B,{detail:{currScroll:e,prevScroll:t}})),t=e}}get elem(){return this.node}async init(t,e){let r=t||document.body;if(this.node=r.querySelector('[data-layout="main-layout"]'),this.node){this.appBarElem=this.node.querySelector(".app-bar"),this.navIcon=this.appBarElem?.querySelector('[data-button="navigation"]'),this.searchIcon=this.appBarElem?.querySelector('[data-button="search"]'),this.drawerElem=this.node.querySelector(".drawer"),this.drawerElem?.classList.remove("drawer-hoverable"),this.headerIconBtn=this.drawerElem?.querySelector('[data-button="header-navigation"]'),this.headerIconElem=this.headerIconBtn?.querySelector('[data-icon="header-navigation-icon"]');let n=this.drawerElem?.querySelector(".drawer-account-bar");this.signInUpElem=n?.querySelector('[data-content="sign-in-up"]'),this.signOutElem=n?.querySelector('[data-content="sign-out"]');let s=this.drawerElem?.querySelector(".drawer-lang-bar");this.langElem=s?.querySelector('[data-content="lang"]'),this.langImageElem=s?.querySelector('[data-image="lang"]'),this.langList=s?.querySelector('[data-list="lang"]'),this.list=this.drawerElem?.querySelector('[data-list="main"]'),this.searchPanel=this.appBarElem?.querySelector(".search"),this.searchForm=this.searchPanel?.querySelector("form"),this.searchInput=this.searchForm?.querySelector(".search-input")}return r}async mount(){this.navIcon?.addEventListener("click",this.navIconClickHandler),this.searchIcon?.addEventListener("click",this.searchIconClickHandler),this.headerIconBtn?.addEventListener("click",this.headerIconBtnClickHandler),this.drawerElem?.querySelector(".drawer-account-bar")?.addEventListener("mouseenter",this.addDrawerHoverClassHandler),this.signInUpElem?.addEventListener("click",this.signInUpElemClickHandler);let e=this.drawerElem?.querySelector(".drawer-lang-bar");e?.addEventListener("mouseenter",this.addDrawerHoverClassHandler);let r=e?.querySelector('input[type="checkbox"]'),n=e?.querySelector(".drawer-lang-bar-current");if(this.langList)for(let s=0;s<this.langList.children.length;s++){let o=this.langList.children[s],a=i=>{n?.classList.add("drawer-lang-bar-current-loading"),c(i,o),r&&(r.checked=!1)};o.addEventListener("click",a),this.langListItemClickHandlers.push(a)}if(this.list)for(let s=0;s<this.list.children.length;s++)this.list.children[s].addEventListener("mouseenter",this.addDrawerHoverClassHandler);this.drawerElem?.addEventListener("mouseleave",this.removeDrawerHoverClassHandler),this.searchInput?.addEventListener("focus",this.searchInputFocusHandler),this.searchForm?.querySelector(".search-icon-right")?.addEventListener("click",this.searchIconRightClickHandler),this.searchForm?.querySelector(".search-icon-left")?.addEventListener("click",this.searchIconLeftClickHandler),this.searchForm?.addEventListener("submit",this.searchFormSubmitHandler),window.addEventListener("scroll",this.windowScrollHandler),await this.content?.mount?.()}async unmount(){if(this.navIcon?.removeEventListener("click",this.navIconClickHandler),this.searchIcon?.removeEventListener("click",this.searchIconClickHandler),this.headerIconBtn?.removeEventListener("click",this.headerIconBtnClickHandler),this.drawerElem?.querySelector(".drawer-account-bar")?.removeEventListener("mouseenter",this.addDrawerHoverClassHandler),this.signInUpElem?.removeEventListener("click",this.signInUpElemClickHandler),this.drawerElem?.querySelector(".drawer-lang-bar")?.removeEventListener("mouseenter",this.addDrawerHoverClassHandler),this.langList)for(let r=0;r<this.langList.children.length;r++)this.langList.children[r].removeEventListener("click",this.langListItemClickHandlers[r]);if(this.langListItemClickHandlers=[],this.list)for(let r=0;r<this.list.children.length;r++)this.list.children[r].removeEventListener("mouseenter",this.addDrawerHoverClassHandler);this.drawerElem?.removeEventListener("mouseleave",this.removeDrawerHoverClassHandler),this.searchInput?.removeEventListener("focus",this.searchInputFocusHandler),this.searchForm?.querySelector(".search-icon-right")?.removeEventListener("click",this.searchIconRightClickHandler),this.searchForm?.querySelector(".search-icon-left")?.removeEventListener("click",this.searchIconLeftClickHandler),this.searchForm?.removeEventListener("submit",this.searchFormSubmitHandler),window.removeEventListener("scroll",this.windowScrollHandler),this.removeDrawerHoverClassHandler(),this.drawerElem?.classList.remove("drawer-open"),await this.content?.unmount?.()}async load(t,e,r){let n=e.query["main-layout-navigation"];if(this.navIcon){let a=`?${h(e.query,"main-layout-navigation")}`;this.navIcon.setAttribute("href",a)}if(this.headerIconBtn){let a=`?${h(e.query,"main-layout-navigation")}`;this.headerIconBtn.setAttribute("href",a)}if(this.searchIcon){let a=`?${h(e.query,"main-layout-search")}`;this.searchIcon.setAttribute("href",a)}if(n?(this.headerIconElem?.classList.remove("drawer-header-icon-hide"),this.drawerElem?.classList.add("drawer-open")):(this.headerIconElem?.classList.add("drawer-header-icon-hide"),this.drawerElem?.classList.remove("drawer-open")),this.signInUpElem&&(this.signInUpElem.textContent=v.tr("Sign In/Up"),this.signInUpElem.setAttribute("href",(t===d?"":`/${t}`)+"/sign-in")),this.signOutElem){this.signOutElem.textContent=v.tr("Sign Out");let a=t===d?"":`/${t}`;this.signOutElem.setAttribute("href",`/auth/sign-out?redirect=${a}/sign-in`)}if(this.drawerElem?.querySelector(".drawer-lang-bar")?.querySelector(".drawer-lang-bar-current")?.classList.remove("drawer-lang-bar-current-loading"),this.langElem&&(this.langElem.textContent=g[t]?.label),this.langImageElem&&(this.langImageElem.src=g[t]?.image),this.langList)for(let a=0;a<this.langList.children.length;a++){let i=this.langList.children[a];i.getAttribute("data-list-item")===`lang-${t}`?i.classList.add("list-item-activated"):i.classList.remove("list-item-activated");let w=i.getAttribute("data-list-item")?.split("-")[1]||d,L=F(location.pathname,w);i.setAttribute("href",`/${L+location.search}`)}}listen(t,e){this.node?.addEventListener(t,e)}unlisten(t,e){this.node?.removeEventListener(t,e)}performAction(t,e){switch(t){case q:window.scrollTo({top:0,behavior:"smooth"});break;case b:window.scrollTo({top:e?.top,behavior:e?.noSmooth?"auto":"smooth"});break}}},u=l;m(u,"layout",null);E.exports={MainLayout:u}});export default D();
